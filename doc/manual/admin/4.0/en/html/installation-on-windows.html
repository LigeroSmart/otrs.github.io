<html><head>
<!-- otrs.github.io -->
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="../../../../../documentation.css">
<script src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="../../../../../documentation.js"></script>
<!-- otrs.github.io -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>OTRS on Windows</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="OTRS 4 - Admin Manual"><link rel="up" href="installation.html" title="Chapter 2. Installation"><link rel="prev" href="web-installer.html" title="Using the web installer"><link rel="next" href="upgrading.html" title="Upgrading OTRS from 3.3 to 4"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">OTRS on Windows</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="web-installer.html">Prev</a> </td><th width="60%" align="center">Chapter 2. Installation</th><td width="20%" align="right"> <a accesskey="n" href="upgrading.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="installation-on-windows"></a>OTRS on Windows</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="installation-on-windows.html#migrating-otrs-from-windows-into-appliance">How to migrate existing Windows installations into the appliance</a></span></dt><dd><dl><dt><span class="section"><a href="installation-on-windows.html#introduction-and-preparation">Introduction and preparation</a></span></dt><dt><span class="section"><a href="installation-on-windows.html#get-otrsclonedb-script-to-clone-databases">Get OTRSCloneDB script to clone databases</a></span></dt><dt><span class="section"><a href="installation-on-windows.html#enable-remote-access-for-appliance-database">Enable remote access for the postgresql database of your appliance</a></span></dt><dt><span class="section"><a href="installation-on-windows.html#backup-appliance-manangement-package">Backup the package of the OTRSApplianceManagement</a></span></dt><dt><span class="section"><a href="installation-on-windows.html#stop-all-otrs-services">Stop OTRS services</a></span></dt><dt><span class="section"><a href="installation-on-windows.html#id-1.4.6.3.7">Drop the existing database of your appliance to have an empty database for the clone data</a></span></dt><dt><span class="section"><a href="installation-on-windows.html#get-password-of-otrs-database">Get the postgresql password of your database</a></span></dt><dt><span class="section"><a href="installation-on-windows.html#clone-database-to-remote-appliance">Clone your database to the remote appliance</a></span></dt><dt><span class="section"><a href="installation-on-windows.html#copy-otrs-base-files-to-remote-appliance">Copy the following files from your windows based system to the appliance</a></span></dt><dt><span class="section"><a href="installation-on-windows.html#reinstall-packages-install-otrs-appliance-management">Reinstall all packages and install the OTRSApplianceManagement</a></span></dt><dt><span class="section"><a href="installation-on-windows.html#disable-remote-access-for-appliance-database">Disable remote access for the postgresql database of your appliance</a></span></dt><dt><span class="section"><a href="installation-on-windows.html#start-all-otrs-services">Start OTRS services</a></span></dt></dl></dd></dl></div><p>
        For running OTRS on windows we highly recommend using the
        <a class="ulink" href="http://otrs.github.io/doc/manual/appliance/stable/en/html/index.html" target="_top">OTRS Appliance</a>.
    </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="migrating-otrs-from-windows-into-appliance"></a>How to migrate existing Windows installations into the appliance</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="introduction-and-preparation"></a>Introduction and preparation</h4></div></div></div><p>
                If you have a windows based installation and you would like to change to the appliance instead then this
                tutorial will support you with the migration of a windows based installation to the new appliance of OTRS.
            </p><p>
                First of all we need to update our OTRS to the latest version of 3.3.x to prevent migration problems.
            </p><p>
                After upgrading your OTRS system you have to set up a separate installation with the OTRS appliance with the
                same version of the windows based installation. E. g. if you are using OTRS 3.3.x you need to install a new OTRS Appliance 3.3.x as well.
                You will find a detailled installation tutorial here:
            </p><p>
                <a class="ulink" href="http://otrs.github.io/doc/manual/appliance/3.3/en/html/" target="_top">
                    <em class="citetitle">Appliance installation manual</em>
                </a>
            </p><p>
                A list of all available appliance downloads can be found here:
            </p><p>
                <a class="ulink" href="http://ftp.otrs.org/pub/otrs/" target="_top">
                    <em class="citetitle">http://ftp.otrs.org/pub/otrs/</em>
                </a>
            </p><p>
                In our example we need the appliance for OTRS 3.3.10:
            </p><p>
                <a class="ulink" href="http://ftp.otrs.org/pub/otrs/otrs-3.3.10-appliance-1.0.10.iso" target="_top">
                    <em class="citetitle">http://ftp.otrs.org/pub/otrs/otrs-3.3.10-appliance-1.0.10.iso</em>
                </a>
            </p><p>
                Now we have 2 operating systems and we need to move our data between the systems.
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="get-otrsclonedb-script-to-clone-databases"></a>Get OTRSCloneDB script to clone databases</h4></div></div></div><p>
                Please go to the admin menu of the windows based system and install the newest version of OTRSCloneDB package into your OTRS:
            </p><p>
                <a class="ulink" href="http://ftp.otrs.org/pub/otrs/packages/" target="_top">
                    <em class="citetitle">http://ftp.otrs.org/pub/otrs/packages/</em>
                </a>
            </p><p>
                Please download the package with the highest version number:
            </p><p>
                </p><pre class="screen">
OTRSCloneDB-1.0.9.opm
                </pre><p>
            </p><p>
                </p><div class="screenshot"><div><img src="screenshots/win-download-otrsclonedb.png"></div></div><p>
            </p><p>
                and install it to your windows based installation:
            </p><p>
                </p><div class="screenshot"><div><img src="screenshots/win-install-otrsclonedb.png"></div></div><p>
            </p><p>
                It is also no problem if you have installed some feature addons or custom developments on your OTRS.
                You just need to take care that all of your installed packages are also compatible with unix based systems.
                For packages provided by OTRS this is the case.
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="enable-remote-access-for-appliance-database"></a>Enable remote access for the postgresql database of your appliance</h4></div></div></div><p>
                The OTSRCloneDB script will copy the database data by remote, so we need to enable the remote access to the
                postgresql database.
            </p><p>
                Connect to your appliance by SSH and chnage into the postgresql directory:
            </p><p>
                </p><pre class="screen">
shell&gt; cd /etc/postgresql/8.4/main
shell&gt; vi postgresql.conf
                </pre><p>
            </p><p>
                Add the following line at the end of the file:
            </p><p>
                </p><pre class="screen">
listen_addresses = '*'
                </pre><p>
            </p><p>
                Save the file.
            </p><p>
                </p><pre class="screen">
shell&gt; vi pg_hba.conf
                </pre><p>
            </p><p>
                Add the following line at the end of the file:
            </p><p>
                </p><pre class="screen">
host all all  0.0.0.0/0 md5
                </pre><p>
            </p><p>
                Save the file.
            </p><p>
                Restart your postgresql server
            </p><p>
                </p><pre class="screen">
shell&gt; service postgresql restart
                </pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="backup-appliance-manangement-package"></a>Backup the package of the OTRSApplianceManagement</h4></div></div></div><p>
                The appliance has always a package called OTRSApplianceManagement installed to have more administrator
                functions in your appliance.
                Before we drop the database of the appliance we need to download the package of the OTRSApplianceManagement.
            </p><p>
                Go to the package manager of your appliance.
            </p><p>
                Choose the package OTRSApplianceManagement and download the package.
            </p><p>
                </p><div class="screenshot"><div><img src="screenshots/win-download-appliance-package.png"></div></div><p>
            </p><p>
                We will need this package again after migration of the windows based system.
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="stop-all-otrs-services"></a>Stop OTRS services</h4></div></div></div><p>
                Stop all running services of your appliance:
            </p><p>
                </p><pre class="screen">
shell&gt; service cron stop
shell&gt; service apache2 stop
shell&gt; su - otrs
shell&gt; cd /opt/otrs/
shell&gt; bin/Cron.sh stop
shell&gt; bin/otrs.Scheduler.pl -a stop
shell&gt; exit
                </pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="id-1.4.6.3.7"></a>Drop the existing database of your appliance to have an empty database for the clone data</h4></div></div></div><p>
                The OTRSCloneDB script will not remove the data in the existing otrs database of the appliance, so we need
                to do this manually:
            </p><p>
                Change the user to the postgresql user:
                </p><pre class="screen">
shell&gt; su - postgres
                </pre><p>
            </p><p>
                Drop the existing otrs database:
                </p><pre class="screen">
shell&gt; dropdb otrs
                </pre><p>
            </p><p>
                Create a new otrs database for the otrs user:
                </p><pre class="screen">
shell&gt; createdb --owner=otrs --encoding=utf8 otrs
                </pre><p>
            </p><p>
                Go back to root user:
                </p><pre class="screen">
shell&gt; exit
                </pre><p>
            </p><p>
                </p><div class="screenshot"><div><img src="screenshots/win-empty-db-appliance.png"></div></div><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="get-password-of-otrs-database"></a>Get the postgresql password of your database</h4></div></div></div><p>
                Change into the OTRS directory of your appliance:
            </p><p>
                </p><pre class="screen">
shell&gt; cd /opt/otrs
                </pre><p>
            </p><p>
                and take a look at the configuration file of your appliance system:
            </p><p>
                </p><pre class="screen">
shell&gt; less Kernel/Config.pm
                </pre><p>
            </p><p>
                You will find your database password if you scroll down a bit:
            </p><p>
                </p><div class="screenshot"><div><img src="screenshots/win-gather-db-data-1.png"></div></div><p>
            </p><p>
                In our example:
            </p><p>
                </p><pre class="screen">
I88cm34A1B6xrl3
                </pre><p>
                Write the pasword down on a piece of paper.
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="clone-database-to-remote-appliance"></a>Clone your database to the remote appliance</h4></div></div></div><p>
                Switch back to your windows based installation and open the SysConfig admin menu.
                Please select the group "OTRSCloneDB" and the subgroup "Configuration":
            </p><p>
                </p><div class="screenshot"><div><img src="screenshots/win_configurate_otrsclonedb_sysconfig-1.png"></div></div><p>
            </p><p>
                We need to configure the SysConfig option OTRSCloneDB::TargetSettings with the following values:
            </p><p>
                </p><pre class="screen">
TargetDatabaseHost =&gt; 192.168.137.20 (Here you need to enter the ip address of your appliance)
TargetDatabase =&gt; otrs
TargetDatabaseUser =&gt; otrs
TargetDatabasePw =&gt; I88cm34A1B6xrl3 (Here you need to set the password of your appliance)
TargetDatabaseType =&gt; postgresql
                </pre><p>
            </p><p>
                </p><div class="screenshot"><div><img src="screenshots/win-configurate-otrsclonedb-sysconfig-2.png"></div></div><p>
            </p><p>
                To run the OTRSCloneDB script we need to switch to the command prompt of our windows based otrs and to chnage into the
                base directory of our OTRS installation:
            </p><p>
                </p><pre class="screen">
shell&gt; cd "C:\otrs"
                </pre><p>
            </p><p>
                If you are using StrawberryPerl, then you maybe need to activate your shell for perl:
            </p><p>
                </p><pre class="screen">
shell&gt; StrawberryPerl\portableshell.bat
                </pre><p>
            </p><p>
                </p><div class="screenshot"><div><img src="screenshots/win-run-otrsclonedb-1.png"></div></div><p>
            </p><p>
                The OTRSCloneDB script is located in the bin directory of the otrs directory.
            </p><p>
                </p><pre class="screen">
shell&gt; cd "OTRS\bin"
                </pre><p>
            </p><p>
                Run the OTRSCloneDB script:
            </p><p>
                </p><pre class="screen">
shell&gt; perl otrs.OTRSCloneDB.pl
                </pre><p>
            </p><p>
                Now you should see some information about the script and its parameters.
            </p><p>
                </p><div class="screenshot"><div><img src="screenshots/win-run-otrsclonedb-2.png"></div></div><p>
            </p><p>
                Note... Errors which occur at running without any parameters could relate to wrong login data for the database or
                problems with the database connection.
            </p><p>
                If no errors occurred, check if the dry run is successfully:
            </p><p>
                </p><pre class="screen">
shell&gt; perl otrs.OTRSCloneDB.pl -n
                </pre><p>
            </p><p>
                </p><div class="screenshot"><div><img src="screenshots/win-run-otrsclonedb-3.png"></div></div><p>
            </p><p>
                Start the cloning of your database and cross your fingers:
            </p><p>
                </p><pre class="screen">
shell&gt; perl otrs.OTRSCloneDB.pl -r
                </pre><p>
            </p><p>
                An example of a successfully run look like this:
            </p><p>
                </p><pre class="screen">
Generating DDL for OTRS.
Generating DDL for package OTRSCloneDB.
Creating structures in target database (phase 1/2)
...
...
Creating structures in target database (phase 2/2)
...
done.
                </pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="copy-otrs-base-files-to-remote-appliance"></a>Copy the following files from your windows based system to the appliance</h4></div></div></div><p>
                Copy the following files from your windows based system:
            </p><p>
                </p><pre class="screen">
C:/otrs/OTRS/Kernel/Config/GenericAgent.pm
C:/otrs/OTRS/Kernel/Config/Files/ZZZAuto.pm
C:/otrs/OTRS/var/article/*
C:/otrs/OTRS/var/log/TicketCounter.log
                </pre><p>
            </p><p>
                to your appliance:
            </p><p>
                </p><pre class="screen">
/opt/otrs/Kernel/Config/GenericAgent.pm
/opt/otrs/Kernel/Config/Files/ZZZAuto.pm
/opt/otrs/var/article/*
/opt/otrs/var/log/TicketCounter.log
                </pre><p>
                Open the file /opt/otrs/Kernel/Config/Files/ZZZAuto.pm on the appliance and replace all paths like "C:/otrs/OTRS/" with "/opt/otrs/"!
            </p><p>
                If you have have manually changes in your Kernel/Config.pm then please copy it to the appliance.
                Don't copy it 1:1 because you will now have different database settings and the file paths on the appliance are different from windows!
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="reinstall-packages-install-otrs-appliance-management"></a>Reinstall all packages and install the OTRSApplianceManagement</h4></div></div></div><p>
                Reinstall all packages to get all custom files back and install the lost
                appliance management package that you donwloaded before.
            </p><p>
                Copy your backup of the OTRSApplianceManagement-1.0.4.opm to the root directory
                of the OTRS system to /opt/otrs.
            </p><p>
                </p><pre class="screen">
shell&gt; bin/otrs.SetPermissions.pl --otrs-user=otrs --otrs-group=otrs --web-user=www-data --web-group=www-data /opt/otrs
shell&gt; su - otrs
shell&gt; cd /opt/otrs
shell&gt; perl bin/otrs.DeleteCache.pl
shell&gt; perl bin/otrs.LoaderCache.pl -o delete
shell&gt; perl bin/otrs.PackageManager.pl -a reinstall-all
shell&gt; perl bin/otrs.PackageManager.pl -a install -p OTRSApplianceManagement-1.0.4.opm
shell&gt; exit
                </pre><p>
            </p><p>
                Fix all permissions in your OTRS system again:
            </p><p>
                </p><pre class="screen">
shell&gt; bin/otrs.SetPermissions.pl --otrs-user=otrs --otrs-group=otrs --web-user=www-data --web-group=www-data /opt/otrs
                </pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="disable-remote-access-for-appliance-database"></a>Disable remote access for the postgresql database of your appliance</h4></div></div></div><p>
                Undo all steps you did to enable the remote access for the postgresql database to your appliance.
            </p><p>
                Change into postgresql directory:
            </p><p>
                </p><pre class="screen">
shell&gt; cd /etc/postgresql/8.4/main
shell&gt; vi postgresql.conf
                </pre><p>
            </p><p>
                Remove the following line at the end of the file:
            </p><p>
                </p><pre class="screen">
listen_addresses = '*'
                </pre><p>
            </p><p>
                Save the file.
            </p><p>
                </p><pre class="screen">
shell&gt; vi pg_hba.conf
                </pre><p>
            </p><p>
                Remove the following line at the end of the file:
            </p><p>
                </p><pre class="screen">
host all all  0.0.0.0/0 md5
                </pre><p>
            </p><p>
                Save the file.
            </p><p>
                Restart your postgresql server
            </p><p>
                </p><pre class="screen">
shell&gt; service postgresql restart
                </pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="start-all-otrs-services"></a>Start OTRS services</h4></div></div></div><p>
                Start services of your appliance:
            </p><p>
                </p><pre class="screen">
shell&gt; service cron start
shell&gt; service apache2 start
shell&gt; su - otrs
shell&gt; cd /opt/otrs/
shell&gt; bin/Cron.sh start
shell&gt; bin/otrs.Scheduler.pl -a start
                </pre><p>
            </p><p>
                Now you should be able to open the OTRS of your appliance in the browser with the imported data of your windows based system.
            </p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="web-installer.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="installation.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="upgrading.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Using the web installer </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Upgrading OTRS from 3.3 to 4</td></tr></table></div></body></html>
