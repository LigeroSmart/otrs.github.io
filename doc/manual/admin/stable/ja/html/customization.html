<html><head>
<!-- otrs.github.io -->
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="../../../../../documentation.css">
<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="../../../../../documentation.js"></script>
<!-- otrs.github.io -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>第5章 カスタマイズ</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="OTRS 3.3 - 管理者マニュアル"><link rel="up" href="index.html" title="OTRS 3.3 - 管理者マニュアル"><link rel="prev" href="scheduler.html" title="OTRSスケジューラ"><link rel="next" href="process-management.html" title="工程管理"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第5章 カスタマイズ</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="scheduler.html">戻る</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="process-management.html">次へ</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="customization"></a>第5章 カスタマイズ</h1></div></div></div><div class="toc"><p><b>目次</b></p><dl class="toc"><dt><span class="section"><a href="customization.html#acl">アクセス・コントロール・リスト(ACL)</a></span></dt><dd><dl><dt><span class="section"><a href="customization.html#id-1.7.2.2">導入</a></span></dt><dt><span class="section"><a href="customization.html#id-1.7.2.3">サンプル</a></span></dt><dt><span class="section"><a href="customization.html#acl-reference">参照</a></span></dt></dl></dd><dt><span class="section"><a href="process-management.html">工程管理</a></span></dt><dd><dl><dt><span class="section"><a href="process-management.html#id-1.7.3.2">導入</a></span></dt><dt><span class="section"><a href="process-management.html#id-1.7.3.3">サンプル・プロセス</a></span></dt><dd><dl><dt><span class="section"><a href="process-management.html#id-1.7.3.3.3">要求の記録</a></span></dt><dt><span class="section"><a href="process-management.html#id-1.7.3.3.4">マネージャーによる承認</a></span></dt><dt><span class="section"><a href="process-management.html#id-1.7.3.3.5">購買部による処理</a></span></dt><dt><span class="section"><a href="process-management.html#id-1.7.3.3.6">郵便室による処理</a></span></dt></dl></dd><dt><span class="section"><a href="process-management.html#id-1.7.3.4">例の実行</a></span></dt><dd><dl><dt><span class="section"><a href="process-management.html#id-1.7.3.4.15">プロセス(コンテナーとしての)</a></span></dt><dt><span class="section"><a href="process-management.html#id-1.7.3.4.16">アクティビティ・ダイアログ</a></span></dt><dt><span class="section"><a href="process-management.html#id-1.7.3.4.17">推移</a></span></dt><dt><span class="section"><a href="process-management.html#id-1.7.3.4.18">推移アクション</a></span></dt><dt><span class="section"><a href="process-management.html#id-1.7.3.4.19">アクティビティ</a></span></dt><dt><span class="section"><a href="process-management.html#id-1.7.3.4.20">本の注文プロセスのパス</a></span></dt></dl></dd><dt><span class="section"><a href="process-management.html#id-1.7.3.5">プロセス構成リファレンス</a></span></dt><dd><dl><dt><span class="section"><a href="process-management.html#id-1.7.3.5.2">プロセス</a></span></dt><dt><span class="section"><a href="process-management.html#id-1.7.3.5.3">アクティビティ</a></span></dt><dt><span class="section"><a href="process-management.html#id-1.7.3.5.4">ActivityDialog（アクティビティ・ダイアログ）</a></span></dt><dt><span class="section"><a href="process-management.html#id-1.7.3.5.5">Transition（推移）</a></span></dt><dt><span class="section"><a href="process-management.html#id-1.7.3.5.6">推移アクション</a></span></dt><dt><span class="section"><a href="process-management.html#process-management-acl">アクセス・コントロール・リスト(ACL)</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="themes.html">自分のテーマの作成</a></span></dt><dt><span class="section"><a href="translation.html">OTRSフロント・エンドのローカライゼーション</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="acl"></a>アクセス・コントロール・リスト(ACL)</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="customization.html#id-1.7.2.2">導入</a></span></dt><dt><span class="section"><a href="customization.html#id-1.7.2.3">サンプル</a></span></dt><dt><span class="section"><a href="customization.html#acl-reference">参照</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="id-1.7.2.2"></a>導入</h3></div></div></div><p>
    OTRS
2.0から、アクセス・コントロール・リスト(ACL)は、チケット、モジュール、キューなどへの制御アクセスに使用することができます。また、ある状況でチケット(完了する、移動するなど)に対するアクションに影響を及ぼすことができます。ACLは<a class="link" href="administration.html#adminarea-roles" title="役割">役割</a>と<a class="link" href="administration.html#adminarea-groups" title="グループ">グループ</a>の既存の許可システムを補足するために使用することができます。ACLを使用すると、システム内の基本的なワークフローは、チケット属性に基づいてマップすることができます。
</p><p>
    まだ、ACLは<a class="link" href="">SysConfig
interface</a>を使用して作成することができません。直接<code class="filename">Kernel/Config.pm</code>ファイルにそれらを入力しなければなりません。本章にはいくつかのACL例がありますので、それらはあなたをACLの諸定義を定義する過程へ導き、あらゆる可能で重要なACL設定の参考となるでしょう。
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="id-1.7.2.3"></a>サンプル</h3></div></div></div><p>
</p><div class="example"><a name="acl-move"></a><p class="title"><b>例5.1 ACLはチケット優先度5のチケットのみをキューへの移動を許可します。</b></p><div class="example-contents"><p>
    この例は、あなたにACLの基本構造を示します。最初に、それは名前を持つ必要があります。ここでは「ACL-Name-2」とします。まず、ACLは実行の前に数値的にソートされることにご留意下さい。それゆえACLの名前を注意深く使用して下さい。
</p><p>
    次に、チケット用のフィルタである「プロパティ」セクションがあります。ここで定義された基準はすべて、ACLが適用されるか否かを判断するチケットに適用されます。例において、チケットが「未対応の」キューかあるいは優先度が「5
非常に高い」にあれば、チケットは一致するでしょう。これはフォーム内での変更により影響を受けます。（「未対応の」キューかあるいは優先度が「3：普通」のチケットが、その後、優先度のドロップダウンが選択され、優先度が「5：非常に高い」へ変更されたような場合）
</p><p>
    最後に、「可能」セクションは画面への修正を定義します。この場合、利用可能キューから、「警告」キューだけがチケット・画面の中で選択することができます。
</p><pre class="programlisting">
# ticket acl
$Self-&gt;{TicketAcl}-&gt;{'100-Example-ACL'} = {
    # マッチプロパティ
    Properties =&gt; {
        # 現在のチケット・マッチ・プロパティ
        Ticket =&gt; {
            Queue =&gt; ['Raw'],
            Priority =&gt; ['5 very high'],
        }
    },
    # 可能なオプション（ホワイトリスト）を返します
    Possible =&gt; {
        # 可能なオプション（ホワイトリスト）を返します
        Ticket =&gt; {
            Queue =&gt; ['Alert'],
        },
    },
};
</pre></div></div><p><br class="example-break">
</p><p>
</p><div class="example"><a name="acl-move2"></a><p class="title"><b>例5.2 
    データベースに格納された優先度5のチケットだけのキューへ移動を許可するACL
</b></p><div class="example-contents"><p>
    この例は先のものに非常に似ています。しかしながら、この例では、「生で」かつ優先度が「５：非常に高い」チケットのみが両者ともにデータベースに保存されて、マッチします。チケットがデータベースの中で実際に更新される前に、この種のACLはフォームの変更を考慮しません。
</p><pre class="programlisting">
# ticket acl
$Self-&gt;{TicketAcl}-&gt;{'100-Example-ACL'} = {
    # マッチプライオリティ
    PropertiesDatabase =&gt; {
        # 現在のチケット・マッチ・プロパティ
        Ticket =&gt; {
            Queue =&gt; ['Raw'],
            Priority =&gt; ['5 very high'],
        }
    },
    # 可能なオプション（ホワイトリスト）を返します
    Possible =&gt; {
        # 可能なオプション（ホワイトリスト）を返します
        Ticket =&gt; {
            Queue =&gt; ['Alert'],
        },
    },
};
</pre></div></div><p><br class="example-break">
</p><p>
</p><div class="example"><a name="acl-close"></a><p class="title"><b>例5.3 未対応のキュー中のチケットの完了を不能にし、閉じるボタンを隠すACL</b></p><div class="example-contents"><p>
    この例では、どのようにチケット・フィールド（の状態）が、（フォームを選択する１つ以上の可能な値で）フィルターされるかを理解できるでしょう。あるチケット用に実行することができる　アクションを制限することも可能です。この場合、チケットは完了できません。
</p><pre class="programlisting">
$Self-&gt;{TicketAcl}-&gt;{'101-Second-Example-ACL'} = {
    # マッチプロパティ
    Properties =&gt; {
        # 現在のチケット・マッチ・プロパティ
        Ticket =&gt; {
            Queue =&gt; ['Raw'],
        }
    },
    # 可能なオプション（ホワイトリスト）を返します
    Possible =&gt; {
        # 可能なオプション（ホワイトリスト）を返します
        Ticket =&gt; {
            State =&gt; ['new', 'open', 'pending reminder'],
        },
        # 可能なアクション・オプション
        Action =&gt; {
            AgentTicketBounce        =&gt; 1,
            AgentTicketClose         =&gt; 0,
            AgentTicketCompose       =&gt; 1,
            AgentTicketCustomer      =&gt; 1,
            AgentTicketForward       =&gt; 1,
            AgentTicketFreeText      =&gt; 1,
            AgentTicketHistory       =&gt; 1,
            AgentTicketLink          =&gt; 1,
            AgentTicketLock          =&gt; 1,
            AgentTicketMerge         =&gt; 1,
            AgentTicketMove          =&gt; 1,
            AgentTicketNote          =&gt; 1,
            AgentTicketOwner         =&gt; 1,
            AgentTicketPending       =&gt; 1,
            AgentTicketPhone         =&gt; 1, # 分かれているアクションを非表示にするためだけに使用されます
            AgentTicketPhoneInbound  =&gt; 1,
            AgentTicketPhoneOutbound =&gt; 1,
            AgentTicketPrint         =&gt; 1,
            AgentTicketPriority      =&gt; 1,
            AgentTicketResponsible   =&gt; 1,
            AgentTicketWatcher       =&gt; 1,
            AgentTicketZoom          =&gt; 1,
            AgentLinkObject          =&gt; 1, # リンク・アクションを非表示にするためだけに使用されます
        },
    },
};
</pre></div></div><p><br class="example-break">
</p><p>
</p><div class="example"><a name="acl-state"></a><p class="title"><b>例5.4 状態：「閉鎖成功」を常に削除するACL</b></p><div class="example-contents"><p>
    ここの例では、否定フィルタ（状態：「完了（成功）」を取り除く）をどのようにして定義可能か例示します。チケット用のマッチ・プロパティを定義しなければ、どんなチケットでもマッチすることもわかります。例えばACLが常に当てはまります。これは、もしデフォルトで特定の値を非表示にしたくかつ、特殊な環境（例えば担当者が特定のグループにいるならば）だけにそれらを可能にしたいなら活用可能になります。
</p><pre class="programlisting">
$Self-&gt;{TicketAcl}-&gt;{'102-Third-ACL-Example'} = {
    # マッチ・プロパティ
    Properties =&gt; {
        # 現在のチケットのマッチ・プロパティ(常にマッチ)
    },
    # 可能なオプションに戻る
    PossibleNot =&gt; {
        # 可能なチケット・オプション
        Ticket =&gt; {
            State =&gt; ['closed successful'],
        },
    },
};
</pre></div></div><p><br class="example-break">
</p><p>
</p><div class="example"><a name="acl-new-ticket-service"></a><p class="title"><b>例5.5 "HW"で始まるキューが作成されるハードウェア・サービス・チケットのみを表示するACL</b></p><div class="example-contents"><p>
    ここでは、マッチするチケットと利用可能なオプションのフィルタリングのための正規表現を使用することができるかについても例示します。
</p><pre class="programlisting">
$Self-&gt;{TicketAcl}-&gt;{'Only-Hardware-Services-for-HW-Queues'} = {
    # マッチ・プロパティ
    # note we don't have "Ticket =&gt; {" because there's no ticket yet
    Properties =&gt; {
    Queue =&gt; {
        Name =&gt; ['[RegExp]HW'],
        }
    },
    # 可能なオプションに戻る
    Possible =&gt; {
        # 可能なチケット・オプション
        Ticket =&gt; {
            Service =&gt; ['[RegExp]^(Hardware)'],
        },
    },
};
</pre></div></div><p><br class="example-break">
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="acl-reference"></a>参照</h3></div></div></div><p>
    下記の例において、ACLで使用可能な全パラメーターのリストがあります。
</p><p>
    ACLをプロセス・チケットに使用する方法の詳細な記述については、<a class="link" href="process-management.html" title="工程管理">ProcessManagement</a>文書で<a class="link" href="">section on ACLs</a> を参照してください。
</p><p>
</p><div class="example"><a name="id-1.7.2.4.4.1"></a><p class="title"><b>例5.6 全ての可能かつ重要なACL設定を示すリファレンス（参照）</b></p><div class="example-contents"><pre class="programlisting">
# ticket acl
$Self-&gt;{TicketAcl}-&gt;{‘200-ACL-Reference’} = {
    # マッチ・プロパティ (フォームからの現在の値)
    Properties =&gt; {

        # 使用されるフロントエンド・モジュール
        Frontend =&gt; {
            Action =&gt; [‘AgentTicketPhone’, ‘AgentTicketEmail’],
        },

        # ログインした担当者
        User =&gt; {
            UserLogin =&gt; [‘some login’],
            Group_rw =&gt; [
                ‘hotline’,
            ],
            Role =&gt; [
                ‘admin’,
            ],
            # …
        },

        # ログインした顧客
        CustomerUser =&gt; {
            UserLogin =&gt; [‘some login’],
            Group_rw =&gt; [
                ‘hotline’,
            ],
            Role =&gt; [
                ‘admin’,
            ],
            # …
        },

        # プロセス・プロパティ
        Process =&gt; {
            ProcessEntityID        =&gt; [‘P1’],   # 現在のチケットがその一部であるプロセス
            ActivityEntityID       =&gt; [‘A1’],   # 現在のチケットのアクティビティ
            ActivityDialogEntityID =&gt; [‘AD1’],  # 担当者/顧客が使用している現在のActivityDialog
        },

        # チケット・プロパティ
        Queue =&gt; {
            Name     =&gt; [‘Raw’],
            QueueID  =&gt; [‘some id’],
            GroupID  =&gt; [‘some id’],
            Email    =&gt; [‘some email’],
            RealName =&gt; [‘OTRS System’],
            # …
        },
        Service =&gt; {
            ServiceID =&gt; [‘some id’],
            Name      =&gt; [‘some name’],
            ParentID  =&gt; [‘some id’],
            # …
        },
        Type =&gt; {
            ID   =&gt; [‘some id’],
            Name =&gt; [‘some name’],
            # …
        },
        Priority = {
            ID   =&gt; [‘some id’],
            Name =&gt; [‘some name’],
            # …
        },
        SLA = {
            SLAID    =&gt; [‘some id’],
            Name     =&gt; [‘some name’],
            Calendar =&gt; [‘some calendar’],
            # …
        },
        State = {
            ID       =&gt; [‘some id’],
            Name     =&gt; [‘some name’],
            TypeName =&gt; [‘some state type name’],,
            TypeID   =&gt; [‘some state type id’],
            # …
        },
        Owner =&gt; {
            UserLogin =&gt; [‘some login’],
            Group_rw =&gt; [
                ‘some group’,
            ],
            Role =&gt; [
                ‘admin’,
            ],
            # …
        },
        Responsible =&gt; {
            UserLogin =&gt; [‘some login’],
            Group_rw =&gt; [
                ‘some group’,
            ],
            Role =&gt; [
                ‘admin’,
            ],
            # …
        },
        DynamicField =&gt; {
            # 名前はDynamicField_&lt;field_name&gt; formatになければなりません。
            # [ … ] の値は常に未翻訳の内部データキーでなければなりません。
            #   動的フィールド定義で指定され、かつ
            #   ユーザに非表示のデータ値です。
            DynamicField_Field1          =&gt; [‘some value’],
            DynamicField_OtherField      =&gt; [‘some value’],
            DynamicField_TicketFreeText2 =&gt; [‘some value’],
            # …
        },
        # 別の方法としてはチケット・プロパティはチケット・ハッシュで指定もできます。
        Ticket =&gt; {
            Queue                =&gt; [‘Raw’],
            State                =&gt; [‘new’, ‘open’],
            Priority             =&gt; [‘some priority’],
            Lock                 =&gt; [‘lock’],
            CustomerID           =&gt; [‘some id’],
            CustomerUserID       =&gt; [‘some id’],
            Owner                =&gt; [‘some owner’],
            DynamicField_Field1  =&gt; [‘some value’],
            DynamicField_MyField =&gt; [‘some value’],
            # …
        },
    },

    # マッチプロパティ (データベースからの既存値)
    PropertiesDatabase =&gt; {
        # プロパティのセクションを御覧ください。ここと同じconfigが使用されています。
        # …
    }

    # 可能なオプションに戻る (ホワイトリスト)
    Possible =&gt; {
        # 可能なチケットオプション (ホワイトリスト)
        Ticket =&gt; {
            Queue =&gt; [‘Hotline’, ‘Coordination’],
            State =&gt; [‘some state’],
            Priority =&gt; [‘5 very high’],
            DynamicField_Field1  =&gt; [‘some value’],
            DynamicField_MyField =&gt; [‘some value’],
            # …
            NewOwner =&gt; [‘some owner’],
            OldOwner =&gt; [‘some owner’],
            # …
        },

        # 担当者/顧客が１つのプロセス・チケットで利用可能な
        #   ActivityDialogs数を制限します。
        ActivityDialog =&gt; [‘AD1’, ‘AD3’],

        # 開始可能なプロセス数を制限します。
        Process =&gt; [‘P1’, ‘P2’],

        # 可能なアクション・オプション (ホワイトリスト)
        Action =&gt; {
            AgentTicketBounce        =&gt; 1,
            AgentTicketClose         =&gt; 1,
            AgentTicketCompose       =&gt; 0,
            AgentTicketCustomer      =&gt; 0,
            AgentTicketForward       =&gt; 0,
            AgentTicketFreeText      =&gt; 1,
            AgentTicketHistory       =&gt; 1,
            AgentTicketLink          =&gt; 0,
            AgentTicketLock          =&gt; 1,
            AgentTicketMerge         =&gt; 0,
            AgentTicketMove          =&gt; 1,
            AgentTicketNote          =&gt; 1,
            AgentTicketOwner         =&gt; 1,
            AgentTicketPending       =&gt; 1,
            AgentTicketPhone         =&gt; 1, # 分割アクションを非表示にするためだけに使用します。
            AgentTicketPhoneInbound  =&gt; 0,
            AgentTicketPhoneOutbound =&gt; 1,
            AgentTicketPrint         =&gt; 1,
            AgentTicketPriority      =&gt; 0,
            AgentTicketResponsible   =&gt; 1,
            AgentTicketWatcher       =&gt; 1,
            AgentTicketZoom          =&gt; 1,
            AgentLinkObject          =&gt; 1, # リンク・アクションを非表示にするためだけに使用します。
        },
    },
    # オプション（ブラックリスト）を削除します
    PossibleNot =&gt; {
        # See section "Possible"
        # …
    },
};
</pre></div></div><p><br class="example-break">
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">注記</h3><p>
        ACLとマッチしている間に、CustomerUserIDパラメーターが送られると、ACLメカニズムは、CustomerUserハッシュを満たすCustomerUser詳細を集めるために、供給されたCustomerUserIDを使用して、定義されたACLを比較します。またそれは、プロパティ（特性）・マッチ用のチケット・ハッシュ中の顧客情報を無効に(override)します。この計算もPropertiesDatabase部分のためになされるが、その一方で、データを集めるために基礎としてチケット・顧客(the
Ticket Customer)を使用しています。
    </p><p>
        顧客・インターフェースでは、CustomerUserIDが現在の記録された顧客ユーザとともに常に送信されることに注目してください。
    </p><p>
        チケット検索画面(AgentTicketSearchとCustomerTicketSearch)では、ACLによって影響を受ける属性のみが動的フィールドであることにご留意下さい。チケット検索画面(AgentTicketSearchとCustomerTicketSearch)では、ACLによる影響を受けた数少ない属性が動的フィールドであることにご留意下さい。すなわち、この(検索)画面は、あなたがその他の属性を制限できないことを意味します。（例えばチケットタイプ、状態、キュー等）
    </p></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="scheduler.html">戻る</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="process-management.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">OTRSスケジューラ </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 工程管理</td></tr></table></div></body></html>
