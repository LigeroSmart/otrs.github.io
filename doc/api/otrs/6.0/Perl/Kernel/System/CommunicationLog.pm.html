<!DOCTYPE html>
<html lang="en" xml:lang="en">
<head>
<!-- otrs.github.io -->
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="../../../../../../documentation.css">
<script src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="../../../../../../documentation.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
<script>
$(document).ready(function() {

    // Hint languages to prevent false matches (php for example).
    hljs.configure({
        languages: ['perl', 'javascript', 'xml', 'html', 'css', 'json', 'yaml']
    });

    // programlistings in manuals
    $('pre.programlisting').each(function(i, block) {
        hljs.highlightBlock(block);
    });
    // code snippets in Perl API docs
    $('.pod pre').addClass('perl').each(function(i, block) {
        hljs.highlightBlock(block);
    });
});</script>
<!-- otrs.github.io -->

<title>Kernel::System::CommunicationLog &mdash; OTRS 6.0 API Reference Perl</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
<body><div class="box">
  <h1 class="t1">OTRS 6.0 API Reference Perl</h1>
  <table>
    <tr>
      <td class="label">Description</td>
      <td class="cell">manuals and libraries</td>
    </tr>
  </table>
</div>
<div class="path">
  <a href="../../index.html">OTRS 6.0 API Reference Perl</a> &gt; Perl Modules &gt;
  Kernel::System::CommunicationLog
</div>
<div>
<a href="../../src/Kernel/System/CommunicationLog.pm">Source</a>
</div>

<div class="pod">


<ul id="index">
  <li><a href="#PUBLIC-INTERFACE">PUBLIC INTERFACE</a>
    <ul>
      <li><a href="#new">new()</a></li>
      <li><a href="#CommunicationStart">CommunicationStart()</a></li>
      <li><a href="#CommunicationStop">CommunicationStop()</a></li>
      <li><a href="#CommunicationGet">CommunicationGet()</a></li>
      <li><a href="#CommunicationGetByObjectID">CommunicationGetByObjectID()</a></li>
      <li><a href="#CommunicationList">CommunicationList()</a></li>
      <li><a href="#CommunicationDelete">CommunicationDelete()</a></li>
      <li><a href="#CommunicationIDGet">CommunicationIDGet()</a></li>
      <li><a href="#TransportGet">TransportGet()</a></li>
      <li><a href="#DirectionGet">DirectionGet()</a></li>
      <li><a href="#StatusGet">StatusGet()</a></li>
      <li><a href="#ObjectLogStart">ObjectLogStart()</a></li>
      <li><a href="#ObjectLogStop">ObjectLogStop()</a></li>
      <li><a href="#ObjectLog">ObjectLog()</a></li>
      <li><a href="#ObjectLogList">ObjectLogList()</a></li>
      <li><a href="#ObjectLogDelete">ObjectLogDelete()</a></li>
      <li><a href="#ObjectGet">ObjectGet()</a></li>
      <li><a href="#ObjectList">ObjectList()</a></li>
      <li><a href="#ObjectLookupSet">ObjectLookupSet()</a></li>
      <li><a href="#ObjectLookupSearch">ObjectLookupSearch()</a></li>
      <li><a href="#ObjectLookupGet">ObjectLookupGet()</a></li>
      <li><a href="#GetConnectionsObjectsAndCommunications">GetConnectionsObjectsAndCommunications()</a></li>
      <li><a href="#ObjectAccountLinkGet">ObjectAccountLinkGet()</a></li>
      <li><a href="#ObjectAccountLabelGet">ObjectAccountLabelGet()</a></li>
      <li><a href="#PRIVATE-INTERFACE">PRIVATE INTERFACE</a></li>
      <li><a href="#SetupLogModule">_SetupLogModule()</a></li>
      <li><a href="#RecoverCommunciationObject">_RecoverCommunciationObject()</a></li>
      <li><a href="#NormalizeDuration">_NormalizeDuration()</a></li>
    </ul>
  </li>
  <li><a href="#TERMS-AND-CONDITIONS">TERMS AND CONDITIONS</a></li>
</ul>

<h1 id="PUBLIC-INTERFACE">PUBLIC INTERFACE</h1>

<h2 id="new">new()</h2>

<p>Creates a CommunicationLog object. Do not use new() directly, instead use the object manager. This is a class which represents a complete communication. Therefore the created instances must not be shared between processes of different communications.</p>

<p>Please use the object manager as follows for this class:</p>

<pre><code>    # Create an object, representing a new communication:
    my $CommunicationLogObject = $Kernel::OM-&gt;Create(
        &#39;Kernel::System::CommunicationLog&#39;,
        ObjectParams =&gt; {
            Transport =&gt; &#39;Email&#39;,
            Direction =&gt; &#39;Incoming&#39;,
            Start     =&gt; 1 # (optional) Immediately start the communication after object creation (Status: Processing). Default: 0
        }
    );

    # Create an object for an already existing communication:
    my $CommunicationLogObject = $Kernel::OM-&gt;Create(
        &#39;Kernel::System::CommunicationLog&#39;,
        ObjectParams =&gt; {
            CommunicationID =&gt; 123,
        }
    );</code></pre>

<h2 id="CommunicationStart">CommunicationStart()</h2>

<p>Create a new communication entry.</p>

<pre><code>    my $Success = $CommunicationLogObject-&gt;CommunicationStart(
        Status =&gt; &#39;Processing&#39;, # (optional) Needs to be either &#39;Successful&#39;, &#39;Processing&#39;, &#39;Warning&#39; or &#39;Failed&#39;
                                # In most of the cases, just &#39;Processing&#39; will make sense at the very beginning
                                # of a communication (Default: &#39;Processing&#39;).
        AccountType =&gt;          # (optional) The used account type
        AccountID   =&gt;          # (optional) The used account id
    );</code></pre>

<p>Returns:</p>

<pre><code>    1 in case of success, 0 in case of errors</code></pre>

<h2 id="CommunicationStop">CommunicationStop()</h2>

<p>Update the status of a communication entry.</p>

<pre><code>    my $Success = $CommunicationLogObject-&gt;CommunicationStop(
        Status =&gt; &#39;Successful&#39;, # (required) Needs to be either &#39;Successful&#39;, &#39;Warning&#39; or &#39;Failed&#39;
    );</code></pre>

<p>Returns:</p>

<pre><code>    1 in case of success, 0 in case of errors</code></pre>

<h2 id="CommunicationGet">CommunicationGet()</h2>

<p>Get a communication entry data.</p>

<pre><code>    my %CommunicationData = $CommunicationLogObject-&gt;CommunicationGet(
        CommunicationID =&gt; 123, # (optional) Default: The CommunicationID set in the object
    );</code></pre>

<p>Returns:</p>

<pre><code>    %CommunicationData = (
        CommunicationID =&gt; 123,
        Transport       =&gt; &#39;Email&#39;,
        Direction       =&gt; &#39;Incoming&#39;,
        Status          =&gt; &#39;Processing&#39;,
        StartTime       =&gt; &#39;2017-05-31 09:26:20&#39;,
        EndTime         =&gt; &#39;2017-05-31 09:30:15&#39;,
        Duration        =&gt; 235,
    );</code></pre>

<h2 id="CommunicationGetByObjectID">CommunicationGetByObjectID()</h2>

<p>Get a communication entry data by a communication object id.</p>

<pre><code>    my %CommunicationData = $CommunicationLogObject-&gt;CommunicationGetByObjectID(
        ObjectID =&gt; 123,
    );</code></pre>

<p>Returns:</p>

<pre><code>    %CommunicationData = (
        CommunicationID =&gt; 123,
        Transport       =&gt; &#39;Email&#39;,
        Direction       =&gt; &#39;Incoming&#39;,
        Status          =&gt; &#39;Processing&#39;,
        StartTime       =&gt; &#39;2017-05-31 09:26:20&#39;,
        EndTime         =&gt; &#39;2017-05-31 09:30:15&#39;,
    );</code></pre>

<h2 id="CommunicationList">CommunicationList()</h2>

<p>List communication entries. If parameters are given, the listing will be filtered, otherwise all available entries will be returned.</p>

<pre><code>    my @CommunicationList = $CommunicationLogObject-&gt;CommunicationList(
        Transport   =&gt; &#39;Email&#39;,      # (optional) Log type/transport/module
        Direction   =&gt; &#39;Incoming&#39;,   # (optional) &#39;Incoming&#39; or &#39;Outgoing&#39;
        Status      =&gt; &#39;Processing&#39;, # (optional) &#39;Successful&#39;, &#39;Processing&#39; or &#39;Failed&#39;
        Date        =&gt; &#39;2017-07-03&#39;, # (optional) List communications just from the given date.
        StartDate   =&gt; &#39;2017-07-03&#39;, # (optional) List communications starting from the given date.
        OlderThan   =&gt; &#39;2017-07-03&#39;, # (optional) List communications older than the given date.
        Result      =&gt; &#39;ARRAY&#39;       # (optional) Can be ARRAY or AVERAGE. ARRAY returns the results as
                                     #            an array while AVERAGE returns the communication average in seconds.
                                     #            Default: ARRAY
        OrderBy     =&gt; &#39;Down&#39;,       # (optional) Down|Up; Default: Down
        SortBy      =&gt; &#39;StartTime&#39;,  # (optional) Transport|Direction|Status|StartTime|EndTime|Duration, default: StartTime
        AccountType =&gt; &#39;POP3&#39;,       # (optional) The used account type
        AccountID   =&gt; 123,          # (optional) The used account id
    );</code></pre>

<p>Returns:</p>

<pre><code>    @CommunicationList = (
        {
            CommunicationID =&gt; 33,
            Transport       =&gt; &#39;Email&#39;,
            Direction       =&gt; &#39;Incoming&#39;,
            Status          =&gt; &#39;Failed&#39;,
            AccountType     =&gt; &#39;IMAPS&#39;,
            AccountID       =&gt; 1,
            StartTime       =&gt; &#39;2017-07-20 08:57:56&#39;,
            EndTime         =&gt; &#39;2017-07-20 08:57:57&#39;,
            Duration        =&gt; 1,
        },
        {
            CommunicationID =&gt; 34,
            Transport       =&gt; &#39;Email&#39;,
            Direction       =&gt; &#39;Outgoing&#39;,
            Status          =&gt; &#39;Successful&#39;,
            AccountType     =&gt; &#39;DoNotSendEmail&#39;,
            AccountID       =&gt; undef,
            StartTime       =&gt; &#39;2017-07-20 08:58:43&#39;,
            EndTime         =&gt; &#39;2017-07-20 08:58:49&#39;
            Duration        =&gt; 6,
        },
    ];</code></pre>

<h2 id="CommunicationDelete">CommunicationDelete()</h2>

<p>Create a new log entry.</p>

<pre><code>    my $Success = $CommunicationLogObject-&gt;CommunicationDelete(
        CommunicationID =&gt; 123, # (required)
    );</code></pre>

<p>Returns:</p>

<pre><code>    1 in case of success, 0 in case of errors</code></pre>

<h2 id="CommunicationIDGet">CommunicationIDGet()</h2>

<p>Returns the communication id.</p>

<pre><code>    my $CommunicationID = $CommunicationLogObject-&gt;CommunicationIDGet();</code></pre>

<p>Returns:</p>

<p>The communication id of the current communication represented by this object.</p>

<h2 id="TransportGet">TransportGet()</h2>

<p>Returns the used transport.</p>

<pre><code>    my $Transport = $CommunicationLogObject-&gt;TransportGet();</code></pre>

<p>Returns:</p>

<p>The transport of the current communication represented by this object.</p>

<h2 id="DirectionGet">DirectionGet()</h2>

<p>Returns the used direction.</p>

<pre><code>    my $Direction = $CommunicationLogObject-&gt;DirectionGet();</code></pre>

<p>Returns:</p>

<p>The direction of the current communication represented by this object.</p>

<h2 id="StatusGet">StatusGet()</h2>

<p>Returns the current Status.</p>

<pre><code>    my $Direction = $CommunicationLogObject-&gt;StatusGet();</code></pre>

<p>Returns:</p>

<p>The status of the current communication represented by this object.</p>

<h2 id="ObjectLogStart">ObjectLogStart()</h2>

<p>Starts a log object of a given object type.</p>

<pre><code>    my $ObjectID = $CommunicationLogObject-&gt;ObjectLogStart(
        ObjectType =&gt; &#39;Connection&#39; # (required) Can be &#39;Connection&#39; or &#39;Message&#39;
    );</code></pre>

<p>Returns:</p>

<pre><code>    1 in case of success, 0 in case of errors</code></pre>

<h2 id="ObjectLogStop">ObjectLogStop()</h2>

<p>Stops a log object of a given object type.</p>

<pre><code>    my $Success = $CommunicationLogObject-&gt;ObjectLogStop(
        ObjectType =&gt; &#39;Connection&#39;                        # (required) Can be &#39;Connection&#39; or &#39;Message&#39;
        ObjectID   =&gt; 123, # (required) The ObjectID of the started object type
    );</code></pre>

<p>Returns:</p>

<pre><code>    1 in case of success, 0 in case of errors</code></pre>

<h2 id="ObjectLog">ObjectLog()</h2>

<p>Adds a log entry for a certain log object.</p>

<pre><code>    my $Success = $CommunicationLogObject-&gt;ObjectLog(
        ObjectType =&gt; &#39;...&#39; # (required) To be defined by the related LogObject
        ObjectID   =&gt; 123, # (required) The ObjectID of the started object type
    );</code></pre>

<p>Returns:</p>

<pre><code>    1 in case of success, 0 in case of errors</code></pre>

<h2 id="ObjectLogList">ObjectLogList()</h2>

<p>List the log entries</p>

<pre><code>    my $List = $CommunicationLogObject-&gt;ObjectLogList(
        ObjectID         =&gt; &#39;...&#39;,   # optional
        ObjectType       =&gt; &#39;...&#39;,   # optional
        ObjectStartTime  =&gt; &#39;...&#39;,   # optional
        ObjectEndTime    =&gt; &#39;...&#39;,   # optional
        ObjectStatus     =&gt; &#39;...&#39;,   # optional
        LogID            =&gt; &#39;...&#39;,   # optional
        LogKey           =&gt; &#39;...&#39;,   # optional
        LogValue         =&gt; &#39;...&#39;,   # optional
        LogPriority      =&gt; &#39;...&#39;,   # optional
        LogCreateTime    =&gt; &#39;...&#39;,   # optional
    );</code></pre>

<p>Returns:</p>

<pre><code>    &lt;undef&gt; - if any error occur
    An arrayref of object log entries - in case of success</code></pre>

<h2 id="ObjectLogDelete">ObjectLogDelete()</h2>

<p>Delete log entries</p>

<pre><code>    my $List = $CommunicationLogObject-&gt;ObjectLogDelete(
        CommunicationID =&gt; 123, # Either CommunicationID or ObjectID must be passed
        ObjectID        =&gt; 123,
    );</code></pre>

<p>Returns:</p>

<pre><code>    1 in case of success, 0 in case of errors</code></pre>

<h2 id="ObjectGet">ObjectGet()</h2>

<p>Get the information relative to a communication object.</p>

<h2 id="ObjectList">ObjectList()</h2>

<p>List the objects information relative to a communication.</p>

<h2 id="ObjectLookupSet">ObjectLookupSet()</h2>

<p>Inserts or updates a lookup information.</p>

<pre><code>    my $Result = $CommunicationLogObject-&gt;ObjectLookupSet(
        ObjectID         =&gt; 123,       # (required)
        TargetObjectType =&gt; &#39;Article&#39;, # (required)
        TargetObjectID   =&gt; 123,       # (required)
    );</code></pre>

<p>Returns:</p>

<pre><code>    &lt;undef&gt; - if any error occur
          1 - in case of success</code></pre>

<h2 id="ObjectLookupSearch">ObjectLookupSearch()</h2>

<p>Get a list of the objects lookup information.</p>

<pre><code>    my $List = $CommunicationLogObject-&gt;ObjectLookupSearch(
        ObjectID         =&gt; &#39;123&#39;,     # (optional)
        ObjectType       =&gt; &#39;Message&#39;, # (optional)
        TargetObjectType =&gt; &#39;Article&#39;, # (optional)
        TargetObjectID   =&gt; &#39;123&#39;,     # (optional)
        CommunicationID  =&gt; &#39;123&#39;,     # (optional)
    );</code></pre>

<p>Returns:</p>

<pre><code>    &lt;undef&gt; - if any error occur
    An arrayref of object lookup - in case of success</code></pre>

<h2 id="ObjectLookupGet">ObjectLookupGet()</h2>

<p>Gets the object lookup information.</p>

<pre><code>    my $Result = $CommunicationLogObject-&gt;ObjectLookupGet(
        TargetObjectID   =&gt; &#39;...&#39;,
        TargetObjecttype =&gt; &#39;...&#39;,
    );</code></pre>

<p>Returns:</p>

<pre><code>    &lt;undef&gt; - if any error occur
    An hashref with object lookup information - in case info exists
    An empty hasref                           - in case info doesn&#39;t exists</code></pre>

<h2 id="GetConnectionsObjectsAndCommunications">GetConnectionsObjectsAndCommunications()</h2>

<p>Method specifically created for optimization purposes for the Support Data Collector. Relays the method for the specific LogModule Transport Module.</p>

<h2 id="ObjectAccountLinkGet">ObjectAccountLinkGet()</h2>

<p>Returns relative link information if AccountType and AccountID are present.</p>

<h2 id="ObjectAccountLabelGet">ObjectAccountLabelGet()</h2>

<p>Returns related account label if AccountType and AccountID are present.</p>

<h2 id="PRIVATE-INTERFACE">PRIVATE INTERFACE</h2>

<p>Private methods</p>

<h2 id="SetupLogModule">_SetupLogModule()</h2>

<p>Setup the needed log module instance, based on the current transport.</p>

<h2 id="RecoverCommunciationObject">_RecoverCommunciationObject()</h2>

<p>Recover a Communication object given an CommunicationID or ObjectID.</p>

<h2 id="NormalizeDuration">_NormalizeDuration()</h2>

<p>Normalize formatted duration string such as <code>HH:MM:SS</code> in seconds.</p>

<h1 id="TERMS-AND-CONDITIONS">TERMS AND CONDITIONS</h1>

<p>This software is part of the OTRS project (<a href="http://otrs.org/">http://otrs.org/</a>).</p>

<p>This software comes with ABSOLUTELY NO WARRANTY. For details, see the enclosed file COPYING for license information (AGPL). If you did not receive this file, see <a href="http://www.gnu.org/licenses/agpl.txt">http://www.gnu.org/licenses/agpl.txt</a>.</p>

</div><div class="footer">generated by <a href="http://search.cpan.org/perldoc?Pod::ProjectDocs">Pod::ProjectDocs</a></div></body></html>

