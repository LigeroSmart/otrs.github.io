(window.webpackJsonp=window.webpackJsonp||[]).push([[248],{"0OgS":function(t,e,n){"use strict";n.r(e);n("GkPX"),n("U8p0"),n("oMRA"),n("W1QL"),n("K/PF"),n("t91x"),n("75LO"),n("e2Kn");var o={name:"BusinessObjectPropertyCustomerUser",components:{CommonClock:function(){return n.e(63).then(n.bind(null,"X54R"))},CommonAvatarAgent:function(){return Promise.all([n.e(10),n.e(67)]).then(n.bind(null,"evpg"))},BusinessObjectWidgetPropertyCustomerLayout:function(){return n.e(51).then(n.bind(null,"NvFU"))}},mixins:[{methods:{switchToCustomer:function(t){var e=this;return this.clientSendRequest({Path:"/agent/auth/switchtouser",Method:"post",Body:{CustomerUserID:t}}).then(function(t){localStorage.setItem("OTRSSwitchToCustomer",t.Body.Token);var n=document.createElement("a"),o=e.$store.getters.serverInfo;n.href="".concat(o.protocol,"//").concat(o.hostname,":").concat(o.port).concat(o.prefixPath,"/external"),n.setAttribute("target","_blank"),document.body.appendChild(n),n.click(),n.remove()})}}}],props:{itemId:{type:[Number,String]},testMode:{type:Boolean,default:!1},testInfo:{type:Object},columnLayout:{type:String}},data:function(){return{info:{}}},computed:{fetchDataUrl:function(){return null},dynamicFields:function(){return this.info.DynamicFields||[]},socialLinks:function(){return this.info.SocialLinks||[]},mapLinks:function(){return this.info.MapLinks||[]},ticketKpi:function(){return this.info.TicketKPI||{}},userId:function(){return this.info.UserID},personalInfo:function(){return this.info.PersonalInfo?this.info.PersonalInfo:{}},preferences:function(){return this.info.Preferences?this.info.Preferences:{}},firstname:function(){return this.personalInfo.UserFirstname?this.personalInfo.UserFirstname.Value:null},lastname:function(){return this.personalInfo.UserLastname?this.personalInfo.UserLastname.Value:null},name:function(){var t=[];return this.firstname&&t.push(this.firstname),this.lastname&&t.push(this.lastname),t.join(" ")},timezone:function(){return this.preferences.UserTimeZone?this.preferences.UserTimeZone:null},language:function(){return this.preferences.UserLanguage?this.preferences.UserLanguage:null},avatar:function(){return this.preferences.UserAvatar?this.preferences.UserAvatar:null},title:function(){return this.personalInfo.UserTitle?this.personalInfo.UserTitle.Value:null},chat:function(){return this.info.Chat?this.info.Chat:{}},switchToCustomerAvailable:function(){return this.info.SwitchToCustomer},additionalInfo:function(){var t=this,e=["UserFirstname","UserLastname","UserTitle"],n=[];return Object.keys(this.personalInfo).forEach(function(o){e.includes(o)||t.personalInfo[o].Value&&n.push({name:o,label:t.personalInfo[o].Label,value:t.personalInfo[o].Value})}),n.sort(function(e,n){return parseInt(t.personalInfo[e.name].Position,10)-parseInt(t.personalInfo[n.name].Position,10)}),n=n.concat(this.dynamicFields.map(function(t){return{name:t.Name,isDynamicField:!0,field:t}})),n}},watch:{itemId:function(){this.fetchData()}},created:function(){this.itemId&&this.fetchData()},methods:{fetchData:function(){var t=this;this.itemId?this.testMode?this.info=this.testInfo:this.clientSendRequest({Path:this.fetchDataUrl,Method:"get"}).then(function(e){t.info=e.Body,t.$nextTick(function(){t.$test.setFlag("WidgetPropertyFetch::CustomerUser::Data")})}).catch(function(e){t.$bus.$emit("showToastMessage",{id:"fetchCustomerPropertyData",heading:"Error loading customer user data",text:"The system could not fetch the customer user data. Please contact the administrator.",variant:"danger"}),t.$log.error("Fetching customer user data failed!",e)}):this.info={}},onStartChat:function(){this.chat.IsOnline},onCreatePhoneTicket:function(){},onCreateEmailTicket:function(){},onSwitchToCustomer:function(){this.switchToCustomer&&this.switchToCustomer(this.info.UserID)},onEditCustomerUser:function(){}}},s=(n("LhCp"),n("psIG")),a=Object(s.a)(o,function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.userId?n("BusinessObjectWidgetPropertyCustomerLayout",{attrs:{type:"CustomerUser","column-layout":t.columnLayout,"ticket-kpi":t.ticketKpi,"additional-info":t.additionalInfo}},[n("b-row",[n("b-col",{staticClass:"py-2 border-bottom InfoCard__Header"},[n("h3",{staticClass:"p-0 m-0"},[t._v("\n                "+t._s(t._f("translate")("Customer User"))+"\n            ")])])],1),t._v(" "),n("b-row",[n("b-col",{staticClass:"py-2 mx-3 px-0 border-bottom InfoCard__Contact"},[n("b-row",[n("b-col",{staticClass:"position-relative",attrs:{cols:"auto"}},[n("CommonAvatarAgent",{staticClass:"mt-0",attrs:{"user-type":"customer",image:t.avatar,user:{UserFirstname:t.firstname,UserLastname:t.lastname}}})],1),t._v(" "),n("b-col",[n("h4",{staticClass:"m-0"},[t._v("\n                        "+t._s(t.name)+"\n                    ")]),t._v("\n                    "+t._s(t.title)+"\n                    "),n("b-row",{staticClass:"mt-1"},[n("b-col",{attrs:{cols:"3"}},[n("CommonClock",{attrs:{timezone:t.timezone}})],1),t._v(" "),n("b-col",{attrs:{cols:"9"}},[n("b-row",[n("b-col",{staticClass:"pr-0",attrs:{cols:"auto"}},[n("CommonIcon",{attrs:{icon:"earth-3"}})],1),t._v(" "),n("b-col",{staticClass:"pl-2 pr-0"},[t._v("\n                                    "+t._s(t._f("translate")(t.language))+"\n                                ")])],1)],1)],1)],1)],1)],1)],1),t._v(" "),n("b-row",[n("b-col",{staticClass:"py-2 mx-3 px-0 border-bottom InfoCard__Meta"},[n("b-row",{attrs:{"align-h":"start"}},[t.chat.Enabled?n("b-col",{attrs:{cols:"auto"}},[n("div",{staticClass:"InfoCard__Label"},[t._v("\n                        "+t._s(t._f("translate")("Chat"))+"\n                    ")]),t._v(" "),n("CommonLink",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"ml-2",attrs:{title:t._f("translate")("Start chat")},on:{click:t.onStartChat}},[n("CommonIcon",{class:{"CommonIcon--Disabled":!t.chat.IsOnline},attrs:{icon:"single-neutral-actions-chat"}})],1)],1):t._e(),t._v(" "),n("b-col",{attrs:{cols:"auto"}},[n("div",{staticClass:"InfoCard__Label"},[t._v("\n                        "+t._s(t._f("translate")("Create"))+"\n                    ")]),t._v(" "),n("CommonLink",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:t._f("translate")("Create phone ticket")},on:{click:t.onCreatePhoneTicket}},[n("CommonIcon",{attrs:{icon:"phone-actions-add"}})],1),t._v(" "),n("CommonLink",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"ml-2",attrs:{title:t._f("translate")("Create email ticket")},on:{click:t.onCreateEmailTicket}},[n("CommonIcon",{attrs:{icon:"email-action-add"}})],1)],1),t._v(" "),n("b-col",{attrs:{cols:"auto"}},[n("div",{staticClass:"InfoCard__Label"},[t._v("\n                        "+t._s(t._f("translate")("Action"))+"\n                    ")]),t._v(" "),t.switchToCustomerAvailable?n("CommonLink",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:t._f("translate")("Switch to customer user")},on:{click:t.onSwitchToCustomer}},[n("CommonIcon",{attrs:{icon:"login-3"}})],1):t._e(),t._v(" "),n("CommonLink",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"ml-2",attrs:{title:t._f("translate")("Edit customer user")},on:{click:t.onEditCustomerUser}},[n("CommonIcon",{attrs:{icon:"single-neutral-actions-edit-1"}})],1)],1),t._v(" "),t.mapLinks.length?n("b-col",{attrs:{cols:"auto"}},[n("div",{staticClass:"InfoCard__Label"},[t._v("\n                        "+t._s(t._f("translate")("Map"))+"\n                    ")]),t._v(" "),t._l(t.mapLinks,function(e,o){return n("CommonLink",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],key:e.Name,class:{"ml-2":o>0},attrs:{title:t._f("translate")(e.Title),link:e.URL,target:e.Target,"is-external":""}},[n("CommonIcon",{attrs:{"weight-with-icon":e.CommonIcon}})],1)})],2):t._e(),t._v(" "),t.socialLinks.length?n("b-col",{attrs:{cols:"auto"}},[n("div",{staticClass:"InfoCard__Label"},[t._v("\n                        "+t._s(t._f("translate")("Social"))+"\n                    ")]),t._v(" "),t._l(t.socialLinks,function(e,o){return n("CommonLink",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],key:e.Name,class:{"ml-2":o>0},attrs:{title:t._f("translate")(e.Title),link:e.URL,target:e.Target,"is-external":""}},[n("CommonIcon",{attrs:{"weight-with-icon":e.CommonIcon}})],1)})],2):t._e()],1)],1)],1)],1):t._e()},[],!1,null,null,null);e.default=a.exports},LhCp:function(t,e,n){"use strict";var o=n("njOo");n.n(o).a},njOo:function(t,e,n){}}]);