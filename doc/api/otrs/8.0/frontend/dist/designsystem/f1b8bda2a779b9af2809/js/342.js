(window.webpackJsonp=window.webpackJsonp||[]).push([[342],{vivt:function(e,t,n){"use strict";n.r(t);n("2Tod"),n("ABKx"),n("W1QL"),n("K/PF"),n("75LO"),n("DbwS"),n("t91x");var r=n("OvAC"),o=n.n(r),i=(n("9ovy"),n("9va6"));function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(n,!0).forEach(function(t){o()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var c={name:"CommonPermanentConfiguration",components:{FormButton:function(){return Promise.all([n.e(1),n.e(24)]).then(n.bind(null,"dphA"))},FormPermanentConfiguration:function(){return n.e(311).then(n.bind(null,"QBNS"))}},props:{screenType:{type:String},moduleType:{type:String},additionalModuleTypeParams:{type:Object,default:null},organizerItemName:{type:String,default:null},testMode:{type:Boolean,default:!1},currentConfig:{type:Object,default:function(){return{}}},widgetId:{type:String},title:{type:String},propOverride:{type:Object}},data:function(){return{dataChanged:!1,currentConfigUpdated:!1,configurationMode:"Medium",formPermanentLoaded:!1}},computed:{permanentConfigUpdateEndpointUrl:function(){return this.isOrganizerConfig&&this.organizerItemName?"frontend/agent/organizer/item/update/".concat(this.organizerItemName):"frontend/agent/config/screen/update/".concat(this.screenType)},isOrganizerConfig:function(){return this.screenType.match(/Organizer/)},configurationFullscreenButtonTitle:function(){return"Medium"===this.configurationMode?"Enter fullscreen":"Exit fullscreen"},localTitle:function(){return this.title?this.title:"Edit screen"}},watch:{currentConfig:{handler:function(e,t){Object(i.isEqual)(e,t)||(!this.currentConfigUpdated&&this.$refs.formPermanentConfig&&this.$refs.formPermanentConfig.resetForm(!0,!0),this.currentConfigUpdated=!1)},deep:!0}},methods:{saveAndClose:function(){this.$refs.formPermanentConfig.submit()},onFormPermanentReady:function(){this.formPermanentLoaded=!0},onFormPermanentValid:function(e){var t=this;if(this.dataChanged)if("BusinessObjectDetailView"!==this.moduleType&&"BusinessObjectOverview"!==this.moduleType&&(e=s({ActiveFilters:{}},e)),this.widgetId)this.emitEventChanged(e);else{var n={};this.isOrganizerConfig?n.Item={Config:s({},this.currentConfig,{},e)}:n.Config=s({},this.currentConfig,{},e),this.clientSendRequest({Path:this.permanentConfigUpdateEndpointUrl,Method:"post",Body:n}).then(function(){t.emitEventChanged()}).catch(function(e){t.$log.error(e),t.$bus.$emit("showToastMessage",{id:"screenConfigUpdate",text:"The permanent screen configuration could not be updated.",variant:"danger",persistent:!1})})}else this.$emit("cancel")},onPermanentFormChanged:function(){this.dataChanged=!0},confirmPermanentCancel:function(){var e=this;return new Promise(function(t){if(!e.dataChanged)return e.$emit("cancel"),void t(!0);e.$bus.$emit("showModalMessage",{id:"confirmPermanentCancel",heading:"Discard Changes",text:"You have unsaved changes. Do you really want to close?",buttonBehavior:"yesNo",okCallback:function(){e.$refs.formPermanentConfig&&e.$refs.formPermanentConfig.resetForm(!0,!0),e.$emit("cancel"),e.dataChanged=!1,t(!0)},cancelCallback:function(){t(!1)}})})},confirmResetToDefault:function(){var e=this;return new Promise(function(t){e.$bus.$emit("showModalMessage",{id:"confirmResetToDefault",heading:"Reset to Default",text:"You have unsaved changes. Do you really want to reset the settings to default?",buttonBehavior:"yesNo",okCallback:function(){e.resetToDefault(),t(!0)},cancelCallback:function(){t(!1)}})})},resetToDefault:function(){var e=this;this.widgetId?this.emitEventReset():this.clientSendRequest({Path:"frontend/agent/config/screen/delete/".concat(this.screenType),Method:"delete"}).then(function(){e.$refs.formPermanentConfig&&e.$refs.formPermanentConfig.resetForm(!0,!0),e.emitEventReset()}).catch(function(t){e.$log.error(t),e.$bus.$emit("showToastMessage",{id:"WebNotificationResetToDefaultMessage",text:"The user settings could not be reset to default.",variant:"danger",persistent:!0})})},toggleConfigurationFullscreen:function(){"Medium"!==this.configurationMode?this.configurationMode="Medium":this.configurationMode="Large"},emitEventChanged:function(e){var t=this;this.$emit("changed",e),this.currentConfigUpdated=!0,this.dataChanged=!1,this.$nextTick(function(){t.$test.setFlag("ScreenConfig::Update")})},emitEventReset:function(){var e=this;this.$emit("reset"),this.currentConfigUpdated=!0,this.dataChanged=!1,this.$nextTick(function(){e.$test.setFlag("ScreenConfig::Update")})}}},l=n("psIG"),u=Object(l.a)(c,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-row",{class:{"Flyout--Large":"Large"===e.configurationMode,"Flyout--Medium":"Medium"===e.configurationMode},attrs:{"no-gutters":""}},[n("b-container",{staticClass:"px-0",attrs:{fluid:""}},[n("header",[n("b-row",{staticClass:"px-4",attrs:{"no-gutters":"","align-v":"center"}},[n("b-col",{staticClass:"text-left",attrs:{cols:"2"}},[n("CommonLink",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{id:"btnFullscreen",title:e._f("translate")(e.configurationFullscreenButtonTitle)},on:{click:function(t){return e.toggleConfigurationFullscreen()}}},[n("CommonIcon",{attrs:{icon:"Large"===e.configurationMode?"shrink-2":"expand-3"}})],1)],1),e._v(" "),n("b-col",{staticClass:"text-center",attrs:{cols:"8"}},[n("h2",[e._v("\n                        "+e._s(e._f("translate")(e.localTitle))+"\n                    ")])]),e._v(" "),n("b-col",{staticClass:"text-right",attrs:{cols:"2"}},[n("CommonLink",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:e._f("translate")("Close configuration")},on:{click:function(t){return e.confirmPermanentCancel()}}},[n("CommonIcon",{attrs:{weight:"bold",icon:"close"}})],1)],1)],1)],1),e._v(" "),n("div",{staticClass:"Settings__Content"},[n("b-row",{staticClass:"pt-2 m-0"},[n("b-col",[e.testMode?e._e():n("FormPermanentConfiguration",{key:"formPermanentConfig",ref:"formPermanentConfig",attrs:{"screen-type":e.screenType,"module-type":e.moduleType,"widget-id":e.widgetId,"organizer-item-name":e.organizerItemName,params:e.additionalModuleTypeParams,"prop-override":e.propOverride},on:{changed:e.onPermanentFormChanged,valid:e.onFormPermanentValid,ready:e.onFormPermanentReady}})],1)],1),e._v(" "),n("b-row",{directives:[{name:"show",rawName:"v-show",value:e.formPermanentLoaded,expression:"formPermanentLoaded"}],staticClass:"p-3 Settings__Actions",attrs:{"no-gutters":"","align-v":"center"}},[e.isOrganizerConfig?e._e():n("b-col",{staticClass:"d-none d-lg-inline",attrs:{cols:"4"}},[n("FormButton",{attrs:{variant:"secondary"},on:{click:function(t){return e.confirmResetToDefault()}}},[n("CommonIcon",{staticClass:"mr-1",attrs:{icon:"synchronize-arrow-1",size:"sm",decorative:""}}),e._v("\n                        "+e._s(e._f("translate")("Reset to Default"))+"\n                    ")],1)],1),e._v(" "),n("b-col",{staticClass:"text-right",attrs:{lg:e.isOrganizerConfig?null:8,cols:"12"}},[e.isOrganizerConfig?e._e():n("FormButton",{staticClass:"d-lg-none",attrs:{variant:"secondary"},on:{click:function(t){return e.confirmResetToDefault()}}},[n("CommonIcon",{staticClass:"mr-1",attrs:{icon:"synchronize-arrow-1",size:"sm",decorative:""}}),e._v("\n                        "+e._s(e._f("translate")("Reset to Default"))+"\n                    ")],1),e._v(" "),n("FormButton",{staticClass:"mr-lg-3",attrs:{variant:"secondary"},on:{click:function(t){return e.confirmPermanentCancel()}}},[e._v("\n                        "+e._s(e._f("translate")("Cancel"))+"\n                    ")]),e._v(" "),n("FormButton",{attrs:{variant:"primary"},on:{click:function(t){return e.saveAndClose()}}},[e._v("\n                        "+e._s(e._f("translate")("Save"))+"\n                    ")])],1)],1)],1)])],1)},[],!1,null,null,null);t.default=u.exports}}]);