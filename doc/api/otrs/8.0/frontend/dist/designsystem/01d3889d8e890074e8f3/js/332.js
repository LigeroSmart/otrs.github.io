(window.webpackJsonp=window.webpackJsonp||[]).push([[332],{vivt:function(t,e,n){"use strict";n.r(e);n("2Tod"),n("ABKx"),n("W1QL"),n("K/PF"),n("75LO"),n("DbwS"),n("t91x");var o=n("OvAC"),r=n.n(o),i=(n("9ovy"),n("9va6"));function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(n,!0).forEach(function(e){r()(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var c={name:"CommonPermanentConfiguration",components:{FormButton:function(){return Promise.all([n.e(1),n.e(24)]).then(n.bind(null,"dphA"))},FormPermanentConfiguration:function(){return n.e(301).then(n.bind(null,"QBNS"))}},props:{screenType:{type:String},moduleType:{type:String},additionalModuleTypeParams:{type:Object,default:null},organizerItemName:{type:String,default:null},testMode:{type:Boolean,default:!1},currentConfig:{type:Object,default:function(){return{}}},widgetId:{type:String},title:{type:String}},data:function(){return{dataChanged:!1,currentConfigUpdated:!1,configurationMode:"Medium"}},computed:{permanentConfigUpdateEndpointUrl:function(){return this.isOrganizerConfig&&this.organizerItemName?"frontend/agent/organizer/item/update/".concat(this.organizerItemName):"frontend/agent/config/screen/update/".concat(this.screenType)},isOrganizerConfig:function(){return this.screenType.match(/Organizer/)},configurationFullscreenButtonTitle:function(){return"Medium"===this.configurationMode?"Enter fullscreen":"Exit fullscreen"},localTitle:function(){return this.title?this.title:"Edit screen"}},watch:{currentConfig:{handler:function(t,e){Object(i.isEqual)(t,e)||(!this.currentConfigUpdated&&this.$refs.formPermanentConfig&&this.$refs.formPermanentConfig.resetForm(!0,!0),this.currentConfigUpdated=!1)},deep:!0}},methods:{saveAndClose:function(){this.$refs.formPermanentConfig.submit()},onFormPermanentValid:function(t){var e=this;if(this.dataChanged)if("BusinessObjectDetailView"!==this.moduleType&&(t=s({ActiveFilters:{}},t)),this.widgetId)this.emitEventChanged(t);else{var n={};this.isOrganizerConfig?n.Item={Config:s({},this.currentConfig,{},t)}:n.Config=s({},this.currentConfig,{},t),this.clientSendRequest({Path:this.permanentConfigUpdateEndpointUrl,Method:"post",Body:n}).then(function(){e.emitEventChanged()}).catch(function(t){e.$log.error(t),e.$bus.$emit("showToastMessage",{id:"screenConfigUpdate",text:"The permanent screen configuration could not be updated.",variant:"danger",persistent:!1})})}else this.$emit("cancel")},onPermanentFormChanged:function(){this.dataChanged=!0},confirmPermanentCancel:function(){var t=this;return new Promise(function(e){if(!t.dataChanged)return t.$emit("cancel"),void e(!0);t.$bus.$emit("showModalMessage",{id:"confirmPermanentCancel",heading:"Discard Changes",text:"You have unsaved changes. Do you really want to close?",buttonBehavior:"yesNo",okCallback:function(){t.$refs.formPermanentConfig&&t.$refs.formPermanentConfig.resetForm(!0,!0),t.$emit("cancel"),t.dataChanged=!1,e(!0)},cancelCallback:function(){e(!1)}})})},confirmResetToDefault:function(){var t=this;return new Promise(function(e){t.$bus.$emit("showModalMessage",{id:"confirmResetToDefault",heading:"Reset to Default",text:"You have unsaved changes. Do you really want to reset the settings to default?",buttonBehavior:"yesNo",okCallback:function(){t.resetToDefault(),e(!0)},cancelCallback:function(){e(!1)}})})},resetToDefault:function(){var t=this;this.widgetId?this.emitEventReset():this.clientSendRequest({Path:"frontend/agent/config/screen/delete/".concat(this.screenType),Method:"delete"}).then(function(){t.$refs.formPermanentConfig&&t.$refs.formPermanentConfig.resetForm(!0,!0),t.emitEventReset()}).catch(function(e){t.$log.error(e),t.$bus.$emit("showToastMessage",{id:"WebNotificationResetToDefaultMessage",text:"The user settings could not be reset to default.",variant:"danger",persistent:!0})})},toggleConfigurationFullscreen:function(){"Medium"!==this.configurationMode?this.configurationMode="Medium":this.configurationMode="Large"},emitEventChanged:function(t){var e=this;this.$emit("changed",t),this.currentConfigUpdated=!0,this.dataChanged=!1,this.$nextTick(function(){e.$test.setFlag("ScreenConfig::Update")})},emitEventReset:function(){var t=this;this.$emit("reset"),this.currentConfigUpdated=!0,this.dataChanged=!1,this.$nextTick(function(){t.$test.setFlag("ScreenConfig::Update")})}}},l=n("psIG"),u=Object(l.a)(c,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-row",{class:{"Flyout--Large":"Large"===t.configurationMode,"Flyout--Medium":"Medium"===t.configurationMode},attrs:{"no-gutters":""}},[n("b-container",{staticClass:"px-0",attrs:{fluid:""}},[n("header",[n("b-row",{staticClass:"px-4",attrs:{"no-gutters":"","align-v":"center"}},[n("b-col",{staticClass:"text-left",attrs:{cols:"2"}},[n("CommonLink",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{id:"btnFullscreen",title:t._f("translate")(t.configurationFullscreenButtonTitle)},on:{click:function(e){return t.toggleConfigurationFullscreen()}}},[n("CommonIcon",{attrs:{icon:"Large"===t.configurationMode?"shrink-2":"expand-3"}})],1)],1),t._v(" "),n("b-col",{staticClass:"text-center",attrs:{cols:"8"}},[n("h2",[t._v("\n                        "+t._s(t._f("translate")(t.localTitle))+"\n                    ")])]),t._v(" "),n("b-col",{staticClass:"text-right",attrs:{cols:"2"}},[n("CommonLink",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:t._f("translate")("Close configuration")},on:{click:function(e){return t.confirmPermanentCancel()}}},[n("CommonIcon",{attrs:{weight:"bold",icon:"close"}})],1)],1)],1)],1),t._v(" "),n("div",{staticClass:"Settings__Content"},[n("b-row",{staticClass:"pt-2 m-0"},[n("b-col",[t.testMode?t._e():n("FormPermanentConfiguration",{key:"formPermanentConfig",ref:"formPermanentConfig",attrs:{"screen-type":t.screenType,"module-type":t.moduleType,"widget-id":t.widgetId,"organizer-item-name":t.organizerItemName,params:t.additionalModuleTypeParams},on:{changed:t.onPermanentFormChanged,valid:t.onFormPermanentValid}})],1)],1),t._v(" "),n("b-row",{staticClass:"p-3 Settings__Actions",attrs:{"no-gutters":"","align-v":"center"}},[t.isOrganizerConfig?t._e():n("b-col",{staticClass:"d-none d-lg-inline",attrs:{cols:"4"}},[n("FormButton",{attrs:{variant:"secondary"},on:{click:function(e){return t.confirmResetToDefault()}}},[n("CommonIcon",{staticClass:"mr-1",attrs:{icon:"synchronize-arrow-1",size:"lg",decorative:""}}),t._v("\n                        "+t._s(t._f("translate")("Reset to Default"))+"\n                    ")],1)],1),t._v(" "),n("b-col",{staticClass:"text-right",attrs:{lg:t.isOrganizerConfig?null:8,cols:"12"}},[t.isOrganizerConfig?t._e():n("FormButton",{staticClass:"d-lg-none",attrs:{variant:"secondary"},on:{click:function(e){return t.confirmResetToDefault()}}},[n("CommonIcon",{staticClass:"mr-1",attrs:{icon:"synchronize-arrow-1",size:"lg",decorative:""}}),t._v("\n                        "+t._s(t._f("translate")("Reset to Default"))+"\n                    ")],1),t._v(" "),n("FormButton",{staticClass:"mr-lg-3",attrs:{variant:"secondary"},on:{click:function(e){return t.confirmPermanentCancel()}}},[t._v("\n                        "+t._s(t._f("translate")("Cancel"))+"\n                    ")]),t._v(" "),n("FormButton",{attrs:{variant:"primary"},on:{click:function(e){return t.saveAndClose()}}},[t._v("\n                        "+t._s(t._f("translate")("Save"))+"\n                    ")])],1)],1)],1)])],1)},[],!1,null,null,null);e.default=u.exports}}]);